if (Get-Command scoop -errorAction SilentlyContinue) {
  "Scoop exist, continue..."
}
else {
  # 安装 Scoop
  Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
  Invoke-RestMethod get.scoop.sh | Invoke-Expression
}
# 添加 bucket
$bucketList = (
  "extras",
  "java",
  "nonportable"
)
ForEach ($Bucket in $bucketList) {
  scoop bucket add $Bucket
}
# 安装 App
$appList = (
  "git",
  "7zip",
  "main/netcat",
  "main/nmap",
  "main/openssh",
  "main/python",
  "main/go",
  "main/frp",
  "java/zulufx-jre",
  "extras/notepad2-zufuliu",
  "extras/vscode",
  "extras/windows-terminal",
  "extras/wireshark",
  "extras/heidisql",
  "extras/sysinternals",
  "extras/putty",
  "extras/firefox-esr",
  "extras/flameshot",
  "extras/vcredist2008"
)
ForEach ($App in $appList) {
  scoop install $App
}
# Config via Reg
reg import "$HOME\scoop\apps\vscode\current\install-context.reg"
reg import "$HOME\scoop\apps\windows-terminal\current\install-context.reg"
regedit "$HOME\scoop\apps\python\current\install-pep-514.reg"
regedt32 "$HOME\scoop\apps\nmap\current\nmap_performance.reg"
# Post installation
&"$HOME\scoop\apps\nmap\current\npcap.exe"
## for burp
Start-Process powershell.exe -ArgumentList "scoop install nonportable/burp-suite-pro-np" -Verb RunAs
7z x ".\burp\x.7z" -px -o".\burp\"
cp ".\burp\" "$HOME\scoop\apps\burp-suite-pro-np\current\"
# 安装 WSL
wsl --set-default-version 2
wsl --install
