# 修改终端 Prompt
$Folder = 'C:\Users\Admin\Documents\WindowsPowerShell'
"Test to see if folder [$Folder] exists"
if (Test-Path -Path $Folder) 
echo 'function Prompt { "[$(get-date )] $Env:USERNAME@$Env:COMPUTERNAME  [$PWD] PS> " }' >> $Folder\Microsoft.PowerShell_profile.ps1
else 
mkdir $Folder
echo 'function Prompt { "[$(get-date )] $Env:USERNAME@$Env:COMPUTERNAME  [$PWD] PS> " }' >> $Folder\Microsoft.PowerShell_profile.ps1
# 修改执行策略
Set-ExecutionPolicy Unrestricted -Scope Process
# 导入并使用 PSWindowsUpdate
Install-Module PSWindowsUpdate 
Import-Module PSWindowsUpdate 
Install-WindowsUpdate -AcceptAll
# Windows Defender 添加排除项
Add-MpPreference -ExclusionPath $HOME\Documents\git-repos\
Add-MpPreference -ExclusionPath $HOME\Downloads\
Add-MpPreference -ExclusionPath $HOME\Documents\scripts\
Add-MpPreference -ExclusionPath $HOME\tools\
Add-MpPreference -ExclusionPath $HOME\scoop\
# 使用 Scoop
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
Invoke-RestMethod get.scoop.sh | Invoke-Expression
# 添加 bucket
$bucketList = (
 "extras",
 "java",
 "nonportable"
)
ForEach ($Bucket in $bucketList) {
 scoop bucket add $Bucket
}
# 安装 App
$appList = (
 "git",
 "7zip",
 "openssh",
 "python",
 "notepad2-zufuliu",
 "vscode",
 "windows-terminal",
 "netcat",
 "nmap",
 "wireshark",
 "java/zulufx-jre",
 "nonportable/burp-suite-community-np",
 "main/go",
 "main/frp",
 "extras/heidisql",
 "extras/sysinternals",
 "extras/putty",
 "extras/firefox-esr",
 "extras/flameshot"
)
ForEach ($App in $appList) {
 scoop install $App
}
reg import "$HOME\scoop\apps\vscode\current\install-context.reg"
reg import "$HOME\scoop\apps\windows-terminal\current\install-context.reg"
regedit $HOME\scoop\apps\python\current\install-pep-514.reg
# 安装 WSL
wsl --set-default-version 2
wsl --install